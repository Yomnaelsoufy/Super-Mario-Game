name: CI

# Controls when the workflow will run
on:
  push:

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      # Checkout the repository
      - name: Checkout code
        uses: actions/checkout@v4

      # Install Node.js (required for running linters)
      - name: Set up Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '18' # Specify the Node.js version you need

      # Install the necessary linters and stylelint-config-standard
      - name: Install linters (htmlhint, stylelint, eslint, stylelint-config-standard)
        run: |
          npm install -g htmlhint stylelint eslint stylelint-config-standard

      # Create stylelint config file
      - name: Create stylelint config
        run: |
          echo '{
            "extends": "stylelint-config-standard"
          }' > .stylelintrc.json

      # Make sure the .stylelintrc.json file is checked
      - name: Verify stylelint config exists
        run: |
          cat .stylelintrc.json

      # Create eslint config file for ESLint v9
      - name: Create eslint config
        run: |
          echo 'export default [
            {
              files: ["**/*.js"],
              rules: {
                "quotes": ["error", "double"],
                "semi": ["error", "always"]
              }
            }
          ];' > eslint.config.js

      # Make sure the eslint.config.js file is checked
      - name: Verify eslint config exists
        run: |
          cat eslint.config.js

      # Run HTML linting
      - name: Lint HTML files
        run: |
          htmlhint "**/*.html"

      # Run CSS linting
      - name: Lint CSS files
        run: |
          stylelint "**/*.css" --config .stylelintrc.json

      # Run JavaScript linting using the new config file
      - name: Lint JavaScript files
        run: |
          eslint "**/*.js" --config eslint.config.js

      # Optional: Fail the workflow if any linting errors are found
      - name: Check for linting errors
        if: failure() # Ensures that if any linting step fails, the build fails
        run: echo "Linting errors found!"
